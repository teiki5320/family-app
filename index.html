<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Famille · App</title>

  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0a0a0d">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
</head>

<body>
<header class="app-header">
  <button id="btnHome" class="home-btn" title="Accueil">🏠</button>
  <h1>Famille</h1>
  <div class="header-actions">
    <button class="ghost" id="btnSettings" title="Paramètres (à venir)">⚙️</button>
  </div>
</header>

<main>
  <!-- Accueil / Dashboard -->
  <section id="home" class="panel active" role="tabpanel">
    <div class="dashboard">
      <div class="hero">
        <div class="hero-top">
          <div class="chip">INFO</div>
        </div>
        <h3>Bienvenue 👋</h3>
        <p class="hero-text">Accès rapide à vos listes, agenda, budgets, documents, messages…</p>
      </div>

      <div class="tiles">
        <button class="tile" data-tab="tasks">
          <div class="icon">📝</div>
          <div class="title">Listes</div>
          <div class="subtitle"><span id="dashTasksCount">0</span> éléments</div>
        </button>

        <button class="tile" data-tab="calendar">
          <div class="icon">📅</div>
          <div class="title">Calendrier</div>
          <div class="subtitle" id="dashNextEvent">Pas d’évènement</div>
        </button>

        <button class="tile" data-tab="budget">
          <div class="icon">🐷</div>
          <div class="title">Budget</div>
          <div class="subtitle">Solde : <span id="dashBalance">0,00 €</span></div>
        </button>

        <button class="tile" data-tab="weather">
          <div class="icon">🌤️</div>
          <div class="title">Météo</div>
          <div class="subtitle" id="wxTile">Chargement…</div>
        </button>

        <button class="tile" data-tab="docs">
          <div class="icon">📁</div>
          <div class="title">Documents</div>
          <div class="subtitle">Dossiers & fichiers</div>
        </button>

        <button class="tile" data-tab="health">
          <div class="icon">⚕️</div>
          <div class="title">Santé</div>
          <div class="subtitle">Carnets & vaccins</div>
        </button>

        <button class="tile" data-tab="vehicles">
          <div class="icon">🚗</div>
          <div class="title">Véhicules</div>
          <div class="subtitle">Fiches & entretiens</div>
        </button>

        <button class="tile" data-tab="chat">
          <div class="icon">💬</div>
          <div class="title">Messages</div>
          <div class="subtitle">Chat familial</div>
        </button>

        <button class="tile" id="tileMenu">
          <div class="icon">🍎</div>
          <div class="title">Menu</div>
          <div class="subtitle">Clic&miam du jour</div>
        </button>
      </div>
    </div>
  </section>

  <!-- Tâches -->
  <section id="tasks" class="panel">
    <h2>Tâches</h2>
    <form id="taskForm" class="row">
      <input id="taskInput" type="text" placeholder="Ex: Acheter du lait…" required>
      <select id="taskWho">
        <option value="Tous">Tous</option>
        <option value="Jean">Jean</option>
        <option value="Laura">Laura</option>
      </select>
      <button type="submit">Ajouter</button>
    </form>
    <ul id="taskList" class="list"></ul>
    <div class="row row-end">
      <button id="clearDone" class="ghost">Effacer terminées</button>
    </div>
  </section>

  <!-- Budget -->
  <section id="budget" class="panel">
    <h2>Budget</h2>
    <form id="txForm" class="row">
      <input id="txLabel" type="text" placeholder="Libellé (ex: Courses)" required>
      <input id="txAmount" type="number" step="0.01" placeholder="Montant (€)" required>
      <select id="txType">
        <option value="-" selected>Dépense</option>
        <option value="+">Revenu</option>
      </select>
      <button type="submit">Ajouter</button>
    </form>
    <div class="cards">
      <div class="card"><div class="muted">Solde</div><div id="balance" class="big">0,00 €</div></div>
      <div class="card"><div class="muted">Dépenses</div><div id="out" class="big">0,00 €</div></div>
      <div class="card"><div class="muted">Revenus</div><div id="in" class="big">0,00 €</div></div>
    </div>
    <ul id="txList" class="list"></ul>
  </section>

  <!-- Météo -->
  <section id="weather" class="panel">
    <h2>Météo</h2>
    <div class="wx-now">
      <div class="wx-main">
        <div class="wx-emoji" id="wxEmoji">⛅</div>
        <div>
          <div class="wx-temp" id="wxTemp">--°</div>
          <div class="wx-desc" id="wxDesc">--</div>
        </div>
      </div>
      <div class="wx-place" id="wxPlace">Localisation…</div>
    </div>
    <ul class="list" id="wxDaily"></ul>
  </section>

  <!-- Notes -->
  <section id="notes" class="panel">
    <h2>Notes</h2>
    <textarea id="notesArea" rows="12" placeholder="Tes notes ici…"></textarea>
    <div class="row row-end">
      <span class="muted" id="notesSaved">Enregistré ✔︎</span>
    </div>
  </section>

  <!-- Calendrier -->
  <section id="calendar" class="panel">
    <h2>Calendrier familial</h2>
    <div class="row" style="flex-wrap:wrap;gap:10px;align-items:center">
      <div class="cal-controls">
        <button id="calPrev" class="ghost">◀︎</button>
        <div id="calMonthLabel" class="cal-month">--</div>
        <button id="calNext" class="ghost">▶︎</button>
        <button id="calToday" class="secondary">Aujourd’hui</button>
      </div>
      <div class="spacer"></div>
      <input id="calSearch" type="search" placeholder="Rechercher…" style="max-width:260px">
      <select id="calFilter" style="max-width:180px">
        <option value="*">Toutes catégories</option>
        <option value="Famille">Famille</option>
        <option value="École">École</option>
        <option value="Santé">Santé</option>
        <option value="Autre">Autre</option>
      </select>
    </div>
    <div id="calGrid" class="cal-grid"></div>
    <form id="eventForm" class="row" style="flex-wrap:wrap; gap:10px; margin-top:15px">
      <input id="eventTitle"  type="text"  placeholder="Titre (ex: RDV pédiatre)" required style="flex:1 1 260px">
      <input id="eventDate"   type="date"   required style="flex:0 0 180px">
      <input id="eventTime"   type="time"   value="09:00" style="flex:0 0 140px">
      <input id="eventPlace"  type="text"   placeholder="Lieu (ex: Clinique ABC)" style="flex:1 1 260px">
      <select id="eventCategory" style="flex:0 0 180px">
        <option value="Famille">Famille</option>
        <option value="École">École</option>
        <option value="Santé">Santé</option>
        <option value="Autre" selected>Autre</option>
      </select>
      <textarea id="eventNote" rows="2" placeholder="Note / description…" style="flex:1 1 100%"></textarea>
      <div class="spacer"></div>
      <button type="submit">Ajouter</button>
    </form>
    <ul id="eventList" class="list"></ul>
  </section>

  <!-- Documents -->
  <section id="docs" class="panel">
    <h2>Documents</h2>

    <!-- Création dossier -->
    <div class="row" id="docsRootTools" style="gap:10px; flex-wrap:wrap">
      <input id="newFolderName" type="text" placeholder="Nouveau dossier (ex: École)" style="flex:1 1 260px">
      <button id="createFolderBtn">Créer dossier</button>
    </div>

    <!-- Grille de dossiers -->
    <div id="folderGrid" class="folder-grid" style="margin-top:12px"></div>

    <hr class="sep">

    <!-- Zone fichiers -->
    <div id="filesArea" class="files-area" style="display:none">
      <div class="row" style="align-items:center; gap:10px; flex-wrap:wrap">
        <h3 id="currentFolderName" style="margin:0">Dossier</h3>
        <div class="spacer"></div>
        <button id="deleteFolderBtn" class="ghost">Supprimer ce dossier</button>
      </div>
      <div class="row" id="fileBar" style="gap:10px; flex-wrap:wrap; margin-top:10px">
        <input id="docFile" type="file" multiple>
        <button id="uploadDocBtn">Ajouter au dossier</button>
      </div>
      <div id="docGrid" class="file-grid"></div>
    </div>
  </section>

  <!-- Santé -->
  <section id="health" class="panel">
    <h2>Santé</h2>

    <!-- Liste personnes -->
    <div class="cards" id="healthPeople"></div>

    <!-- Ajouter / éditer personne -->
    <details class="box">
      <summary>Ajouter une personne</summary>
      <form id="healthAddForm" class="grid2">
        <input name="name" placeholder="Prénom" required>
        <input name="blood" placeholder="Groupe sanguin (ex: O+)">
        <input name="allergies" placeholder="Allergies (séparées par ,)">
        <input name="conditions" placeholder="Maladies chroniques (séparées par ,)">
        <input name="doctor" placeholder="Médecin traitant">
        <input name="emergency" placeholder="Contact d’urgence (nom · tel)">
        <button type="submit">Ajouter</button>
      </form>
    </details>
  </section>

  <!-- Véhicules -->
  <section id="vehicles" class="panel">
    <h2>Véhicules</h2>

    <!-- Liste véhicules -->
    <div class="cards" id="vehicleList"></div>

    <!-- Ajouter véhicule -->
    <details class="box">
      <summary>Ajouter un véhicule</summary>
      <form id="vehicleAddForm" class="grid2">
        <input name="plate" placeholder="Immatriculation (ex: AB-123-CD)" required>
        <input name="make" placeholder="Marque (ex: Peugeot)">
        <input name="model" placeholder="Modèle (ex: 308)">
        <input name="year" type="number" placeholder="Année (ex: 2018)">
        <input name="vin" placeholder="VIN (optionnel)">
        <input name="mileage" type="number" placeholder="Kilométrage actuel">
        <button type="submit">Ajouter</button>
      </form>
    </details>
  </section>

  <!-- Messages -->
  <section id="chat" class="panel">
    <h2>Chat familial</h2>
    <div class="row">
      <input id="chatName" type="text" placeholder="Ton prénom (ex: Jean)">
      <div class="spacer"></div>
      <small class="muted">Privé • messages & fichiers 30 jours</small>
    </div>
    <div id="chatList" class="chat-messages"></div>
    <div class="row">
      <textarea id="chatInput" rows="2" placeholder="Écris un message… (Entrée = envoyer)"></textarea>
    </div>
    <div class="row">
      <input id="chatFile" type="file">
      <button id="chatUpload" class="ghost">Joindre</button>
      <div class="spacer"></div>
      <button id="chatSend">Envoyer</button>
    </div>
  </section>
</main>

<footer class="app-footer">
  <small>App locale -- modifie librement dans Textastic ✦</small>
</footer>

<script src="app.js"></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js').catch(console.error);
  });
}
</script>
</body>
</html>